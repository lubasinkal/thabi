# Data Sources in Your Flood Risk Model

## ğŸ“Š **Current Status: SYNTHETIC Data**

Your model currently uses **100% synthetic (fake) data** generated by `synthetic_claims.py`.

---

## ğŸ”„ **What Data You're Using**

### **Synthetic Claims + Synthetic Climate** (Currently Active âœ…)

**Generated by**: `synthetic_claims.py`

**What it creates**:
```
250 flood claims over 5 years
â”œâ”€â”€ date: Random dates between 2020-2025
â”œâ”€â”€ loss_amount: $25k-$500k+ (Pareto-distributed)
â”œâ”€â”€ SSI: 0.1-0.6 (fake soil saturation)
â””â”€â”€ rainfall_7day: 0-200mm (fake 7-day rainfall)
```

**How climate affects losses**:
- Higher SSI â†’ Lower q â†’ Larger claims
- Built-in correlation for testing
- Seasonal patterns (rainy season effect)

**Why synthetic?**
- No real Molapo claims data available yet
- Allows testing the full pipeline
- Validates model logic before using real data

---

## ğŸŒ **Real Climate Data Available** (Built but Not Used âŒ)

**Fetched by**: `climate_data.py` from **Open-Meteo Archive API**

**What it provides**:
```
Real historical data for any location
â”œâ”€â”€ precipitation_mm: Daily precipitation
â”œâ”€â”€ rainfall_mm: Daily rainfall
â”œâ”€â”€ temperature_2m_max: Max temperature
â”œâ”€â”€ temperature_2m_min: Min temperature
â”œâ”€â”€ rainfall_7day: 7-day rolling sum
â””â”€â”€ SSI: Proxy from 30-day cumulative rainfall
```

**Example (Botswana region)**:
- 1,827 days (2020-2024)
- Mean SSI: 0.117
- Max SSI: 0.617 (Feb 2021 - extreme flood event)
- Real precipitation patterns captured

**Note**: SSI is a **proxy** calculated from rainfall because soil moisture data is not available in the archive API. Formula:
```
SSI = (30-day cumulative rainfall / 300mm) clipped to [0, 1]
```

---

## ğŸ”€ **How to Switch to Real Climate Data**

### **Option 1: Real Climate + Synthetic Claims** (Best for Now)

Update `main.py`:
```python
from climate_data import get_climate_data
import pandas as pd

# In main():
# Step 1: Get real climate
climate_df = get_climate_data(
    latitude=-25.7479,   # Molapo coordinates
    longitude=25.9269,
    start_date="2020-01-01",
    end_date="2024-12-31"
)

# Step 2: Generate synthetic claims
claims = generate_synthetic_claims(n_years=5)

# Step 3: Merge - match each claim to real climate on that date
claims['date'] = pd.to_datetime(claims['date']).dt.tz_localize(None)
climate_df['date'] = pd.to_datetime(climate_df['date']).dt.tz_localize(None)

claims = claims.merge(
    climate_df[['date', 'SSI', 'rainfall_7day']], 
    on='date', 
    how='left',
    suffixes=('_drop', '')
)

# Drop synthetic climate columns
claims = claims[['date', 'loss_amount', 'SSI', 'rainfall_7day']]
```

---

### **Option 2: Real Claims + Real Climate** (Production)

When you get actual Molapo insurance claims:

```python
from climate_data import get_climate_data
import pandas as pd

# Load real claims
claims = pd.read_csv('molapo_claims.csv')
claims['date'] = pd.to_datetime(claims['date_of_loss'])

# Fetch climate for the same period
start = claims['date'].min().strftime('%Y-%m-%d')
end = claims['date'].max().strftime('%Y-%m-%d')

climate_df = get_climate_data(
    latitude=-25.7479,
    longitude=25.9269,
    start_date=start,
    end_date=end
)

# Merge
claims = claims.merge(climate_df, on='date', how='left')
```

---

## ğŸ“ **Summary Table**

| Component | Current Source | Available Alternative | Status |
|-----------|---------------|----------------------|---------|
| Claims (loss amounts) | Synthetic | Real Molapo data (TBD) | âš ï¸ Waiting |
| Claim dates | Synthetic | Real Molapo data (TBD) | âš ï¸ Waiting |
| SSI (soil saturation) | Synthetic | Real (rainfall proxy) | âœ… Built |
| Rainfall | Synthetic | Real (Open-Meteo) | âœ… Built |
| Temperature | N/A | Real (Open-Meteo) | âœ… Built |

---

## ğŸ¯ **Next Steps**

1. **Test with real climate** (5 minutes):
   ```bash
   uv run python test_real_climate.py
   ```
   This creates `real_molapo_climate_data.csv`

2. **Integrate real climate** (modify main.py):
   - Replace synthetic climate with real climate
   - Keep synthetic claims for now

3. **Wait for real claims data**:
   - Once you have `molapo_claims.csv`, replace synthetic claims
   - Ensure columns: `date`, `loss_amount`

4. **Validate model**:
   - Check if Î²â‚ is negative (higher SSI â†’ lower q)
   - Validate against known flood events

---

## ğŸ’¡ **Limitations of Current SSI Proxy**

**Real soil moisture** (not available):
- Direct measurement from ground sensors
- Accurate representation of saturation

**Current SSI proxy** (using rainfall):
- Assumes rainfall â†’ soil saturation
- Ignores drainage, evaporation, soil type
- Good approximation for flood modeling

**For production**: Consider integrating soil moisture models or satellite data (e.g., SMAP, SMOS).
